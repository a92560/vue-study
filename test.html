<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
  const log = console.log;
  const delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

  const subFlow = createFlow([() => delay(1000).then(() => log("c"))]);

  createFlow([
    () => log("a"),
    () => log("b"),
    subFlow,
    [() => delay(1000).then(() => log("d")), () => log("e")],
  ]).run(() => {
    console.log("done");
  });

  function createFlow(list = []) {
    return {
      list: [...list].flat(Infinity),
      async run(cb = () => {}) {
        for (let i = 0; i < this.list.length; i ++) {
          const it = this.list[i];
          typeof it === 'function' ? await it() : await it.run();
        }
        cb();
      },
    }
  }
</script>
</body>
</html>
